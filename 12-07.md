# Домашнее задание к занятию «Репликация и масштабирование. Часть 2»

### Инструкция по выполнению домашнего задания

1. Сделайте fork [репозитория c шаблоном решения](https://github.com/netology-code/sys-pattern-homework) к себе в Github и переименуйте его по названию или номеру занятия, например, https://github.com/имя-вашего-репозитория/gitlab-hw или https://github.com/имя-вашего-репозитория/8-03-hw).
2. Выполните клонирование этого репозитория к себе на ПК с помощью команды `git clone`.
3. Выполните домашнее задание и заполните у себя локально этот файл README.md:
   - впишите вверху название занятия и ваши фамилию и имя;
   - в каждом задании добавьте решение в требуемом виде: текст/код/скриншоты/ссылка;
   - для корректного добавления скриншотов воспользуйтесь инструкцией [«Как вставить скриншот в шаблон с решением»](https://github.com/netology-code/sys-pattern-homework/blob/main/screen-instruction.md);
   - при оформлении используйте возможности языка разметки md. Коротко об этом можно посмотреть в [инструкции по MarkDown](https://github.com/netology-code/sys-pattern-homework/blob/main/md-instruction.md).
4. После завершения работы над домашним заданием сделайте коммит (`git commit -m "comment"`) и отправьте его на Github (`git push origin`).
5. Для проверки домашнего задания преподавателем в личном кабинете прикрепите и отправьте ссылку на решение в виде md-файла в вашем Github.
6. Любые вопросы задавайте в чате учебной группы и/или в разделе «Вопросы по заданию» в личном кабинете.

Желаем успехов в выполнении домашнего задания.

---

### Задание 1

Опишите основные преимущества использования масштабирования методами:

- активный master-сервер и пассивный репликационный slave-сервер; 
- master-сервер и несколько slave-серверов;
- активный сервер со специальным механизмом репликации — distributed replicated block device (DRBD);
- SAN-кластер.

*Дайте ответ в свободной форме.*

#### Ответ:

##### Активный master-сервер и пассивный репликационный slave-сервер
Самый простой уровень репликации. Из преимуществ можно выделить снижение нагрузки на Master-сервер по чтению. Однако, при большом увеличении объема базы данных потребуется вертикально расширять сервера, особенно Master, т.к. он работает не только на чтение, но и на запись. Стоит отметить, что на скорость чтения данных будет влиять вид записи (синхронная и асинхронная). При синхронной записи шанс потери данных ниже, но и скорость чтения данных тоже будет ниже.  

##### Master-сервер и несколько slave-серверов
Схема идентична первому пункту. В качестве преимущества использования такой схемы можно выделить распределение нагрузки между Slave-серверами базы данных. Например, можно настроить репликацию части базы данных отдельно на каждый Slave то есть: Slave1 реплицирует часть базы с пользователями, Slave2 реплицирует часть базы с книгами в наличии и тд. 

##### Активный сервер со специальным механизмом репликации — distributed replicated block device (DRBD)
Этот вариант является программным решением для хранения данных. DRBD включает в себя копию данных на двух устройствах хранения, так что в случае сбоя одного из них можно использовать данные на другом. Тут происходит реплицикация блочных устройств (жесткие диски, разделы, логические тома и т.д.) между хостами по сети и зеркально отображает их содержимое. По сути это вариант можно назвать даже RAID1 для БД. Данный вариант может применяться для ряда задач в кластерах высокой доступности (High Availability).

##### SAN-кластер
Это "выделенная сеть", отделенная от локальных (LAN) и глобальных (WAN) сетей. Преимущества - разделяемый доступ к дискам и ленточным устройствам, большая производительность репликации данных, лучшая масштабируемость дисковой системы и расширенная отказоустойчивость. Архитектура SAN так же обеспечивает возможность безболезненного роста. Техника управления емкостью хранилищ данных может быть использована что бы обеспечить постоянное ее увеличение по мере необходимости. Если необходимо увеличение вычислительной мощности, SAN позволяет добавлять новые серверы таким образом, что они будут иметь разделяемый доступ к данным. Для увеличения скорости доступа к данным, могут быть созданы несколько их копий, это позволяет преодолеть ограничение производительности одного диска.


---

### Задание 2


Разработайте план для выполнения горизонтального и вертикального шаринга базы данных. База данных состоит из трёх таблиц: 

- пользователи, 
- книги, 
- магазины (столбцы произвольно). 

Опишите принципы построения системы и их разграничение или разбивку между базами данных.

*Пришлите блоксхему, где и что будет располагаться. Опишите, в каких режимах будут работать сервера.* 

#### Ответ:

Я считаю, что в такой базе данных самый большой объем информации занимают данные о книгах (автор, жанр, название, год издания и тд), отталкияваясь от этого я бы сделал горизонтальное масштабирование, разделив все книги, например, по названию и разграничив их в алфавитном порядке между серверами: 
первый сервер БД A-I 
второй сервер БД J-R
третий сервер БД S-Z

При условии, что сеть магазинов не большая, то остальные данные (пользователи, и магазины) можно попробовать расположить на одном сервере, сделав репликацию серверов БД в режиме master-master 
Таким образом мы получаем схему: 

![image](https://github.com/Redcorprus/sdb-homeworks/blob/main/img/12-07/img1.png)

Если сеть магазинов крупная, то можно распределить нагрузку между серверами БД по другому принципу, используя горизонтальное и вертикальное масштабирование, разграничив БД между серверами:
первый сервер БД USER 
второй сервер БД BOOK
третий сервер БД STORE

Основной сервер БД сделать Master, остальные серверы сделать Slave.
Таким образом мы получаем схему: 

![image](https://github.com/Redcorprus/sdb-homeworks/blob/main/img/12-07/img2.png)


## Дополнительные задания (со звёздочкой*)
Эти задания дополнительные, то есть не обязательные к выполнению, и никак не повлияют на получение вами зачёта по этому домашнему заданию. Вы можете их выполнить, если хотите глубже шире разобраться в материале.

---
### Задание 3*

Выполните настройку выбранных методов шардинга из задания 2.

*Пришлите конфиг Docker и SQL скрипт с командами для базы данных*.
